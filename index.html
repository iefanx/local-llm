<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <!-- Allow user scaling for accessibility (max-scale 5 is the minimum for WCAG) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover" />
    <meta name="theme-color" content="#000000" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>Aithena</title>
    <!-- Preconnect to CDNs for faster loading -->
    <link rel="preconnect" href="https://huggingface.co" crossorigin />
    <link rel="dns-prefetch" href="https://huggingface.co" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    <link rel="manifest" href="/manifest.webmanifest">
</head>

<body>
    <!-- Main landmark for accessibility -->
    <main class="chat-container">
        <header class="header">
            <div class="logo">
                <span class="logo-icon" aria-hidden="true">Î›</span>
                <span class="logo-text">Aithena</span>
            </div>
            <button id="settings-btn" class="icon-btn" aria-label="Open settings">
                <i data-lucide="settings" aria-hidden="true"></i>
            </button>
        </header>

        <div id="download-section" class="hidden">
            <div class="settings-header">
                <h2>Settings</h2>
                <button id="close-settings-btn" class="icon-btn close-btn" aria-label="Close settings">
                    <i data-lucide="x" aria-hidden="true"></i>
                </button>
            </div>

            <p>Model</p>
            <div class="download-container">
                <select id="model-selection" aria-label="Select AI model"></select>
                <button id="download" title="Download Model" aria-label="Download selected model">
                    <i data-lucide="download" aria-hidden="true"></i>
                </button>
            </div>
            <input type="file" id="model-file-input" accept=".bin,.task,.litertlm,.lmrt" hidden />
            <p class="model-hint">All models require one-time download from HuggingFace</p>
            <p id="download-status" class="hidden"></p>

            <!-- System Prompt Settings -->
            <div class="system-prompt-section">
                <button id="sys-prompt-toggle" class="settings-btn small-btn">
                    <i data-lucide="brain-circuit"></i>
                    <span>System Prompt</span>
                    <i data-lucide="chevron-down" class="chevron"></i>
                </button>
                <div id="sys-prompt-editor" class="hidden">
                    <textarea id="sys-prompt-input" autocomplete="off" spellcheck="false"></textarea>
                    <button id="sys-prompt-reset" class="reset-link">Reset to Default</button>
                </div>
            </div>
            <label class="settings-option">
                <input type="checkbox" id="voice-response-toggle" checked />
                <span>Enable Voice Responses</span>
            </label>

            <div class="settings-actions">
                <button id="clear-chat" class="settings-btn" title="Clear Chat">
                    <i data-lucide="trash-2"></i>
                    <span>Clear Chat</span>
                </button>
            </div>

            <!-- Brain Section -->
            <div class="brain-section">
                <div class="settings-header" style="margin-top: 24px; border-bottom: none; padding-bottom: 0;">
                    <h2>Brain</h2>
                </div>
                <p class="model-hint" style="text-align: left; margin-bottom: 12px; margin-top: 8px;">Managed Memories
                </p>

                <div id="brain-status" class="brain-status"></div>
                <div id="brain-progress" class="brain-progress hidden">
                    <div class="progress-bar">
                        <div id="brain-progress-fill" class="progress-fill"></div>
                    </div>
                    <div id="brain-progress-text" class="progress-text">Processing...</div>
                </div>

                <div class="brain-stats">
                    <span id="brain-memory-count">0 memories</span>
                </div>

                <div class="brain-actions">
                    <button id="upload-memory" class="settings-btn small-btn" disabled>
                        <i data-lucide="upload"></i>
                        <span>Upload</span>
                    </button>
                    <button id="clear-memories" class="settings-btn small-btn danger-btn">
                        <i data-lucide="trash-2"></i>
                        <span>Clear All</span>
                    </button>
                </div>
                <input type="file" id="brain-file-input" accept=".pdf,.txt,.md,.csv,.json" multiple hidden />
                <p class="brain-hint">Supported: PDF, TXT, MD, CSV, JSON</p>
            </div>
        </div>
        <div id="chat-box" class="chat-box" role="log" aria-live="polite" aria-label="Chat messages"></div>
        <div id="chat-stats" class="chat-stats hidden" aria-hidden="true"></div>
        <div class="chat-input-container" role="form">
            <button id="mic-btn" class="icon-btn mic-btn" title="Voice Mode" aria-label="Toggle voice input">
                <i data-lucide="mic"></i>
            </button>
            <input type="text" id="user-input" placeholder="Type a message..." aria-label="Chat message input"
                autocomplete="off" />
            <button id="send" disabled title="Send Message" aria-label="Send message">
                <i data-lucide="arrow-up"></i>
            </button>
        </div>
    </main>

    <script type="module" src="/src/main.js"></script>
</body>

</html>